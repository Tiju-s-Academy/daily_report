<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <!-- Admin Rule: See All Reports -->
    <record id="rule_admin_report" model="ir.rule">
        <field name="name">Admin: See All Reports</field>
        <field name="model_id" ref="model_employee_report"/>
        <field name="groups" eval="[(4, ref('admin_report'))]"/>
        <field name="domain_force">[(1, '=', 1)]</field>
    </record>
    <record id="rule_directors_report" model="ir.rule">
        <field name="name">VP: Approve anytime</field>
        <field name="model_id" ref="model_employee_report"/>
        <field name="groups" eval="[(4, ref('directors_report'))]"/>
        <field name="domain_force">
        ['|',
            ('create_uid', '=', user.id),
            ('name', 'child_of', user.employee_id.id)
        ]
        </field>
    </record>

    <!-- User Rule: See Own and Managed Records -->
    <record id="rule_user_report" model="ir.rule">
        <field name="name">User: See Own and Managed Records</field>
        <field name="model_id" ref="model_employee_report"/>
        <field name="groups" eval="[(4, ref('user_report'))]"/>
        <field name="domain_force">
        ['|',
            ('create_uid', '=', user.id),
            ('name', 'child_of', user.employee_id.id)
        ]
        </field>
    </record>
    <record id="rule_staff_report" model="ir.rule">
        <field name="name">Staff: See Own and Records</field>
        <field name="model_id" ref="model_support_staff"/>
        <field name="groups" eval="[(4, ref('staff_report'))]"/>
        <field name="domain_force">
            [
            ('create_uid', '=', user.id)
            ]
        </field>
    </record>
    <record id="rule_staff_report_manager" model="ir.rule">
        <field name="name">Staff Manger: See Own and Managed Records</field>
        <field name="model_id" ref="model_support_staff"/>
        <field name="groups" eval="[(4, ref('staff_manager'))]"/>
        <field name="domain_force">
            [
            ('name.parent_id.user_id', '=', user.id),
            ('state','!=','draft')
            ]
        </field>
    </record>
    <record id="rule_concerns_manager_all_concerns" model="ir.rule">
        <field name="name">Concerns Manager: See All Concerns</field>
        <field name="model_id" ref="model_employee_report"/>
        <field name="groups" eval="[(4, ref('daily_report.concerns_manager_group'))]"/>
        <field name="domain_force">[(1, '=', 1)]</field>
    </record>
    <record id="rule_concerns_manager_only_concerns" model="ir.rule">
        <field name="name">Concerns Manager: Only See Concerns</field>
        <field name="model_id" ref="model_employee_report"/>
        <field name="groups" eval="[(4, ref('daily_report.concerns_manager_group'))]"/>
        <field name="domain_force">[('has_concerns', '=', True)]</field>
    </record>

    <!-- Rule to restrict access to subordinates' records -->
    <record id="rule_employee_report_subordinates" model="ir.rule">
        <field name="name">Employee Report: Subordinates Only</field>
        <field name="model_id" ref="model_employee_report"/>
        <field name="groups" eval="[(4, ref('base.group_user'))]"/>
        <field name="domain_force">[
            '|',
            ('name.parent_id.user_id', '=', user.id),  /* Subordinates */
            ('create_uid', '=', user.id)              /* Own records */
        ]</field>
    </record>

    <!-- Rule to allow access to all records with concerns -->
    <record id="rule_employee_report_all_concerns" model="ir.rule">
        <field name="name">Employee Report: All Concerns</field>
        <field name="model_id" ref="model_employee_report"/>
        <field name="groups" eval="[(4, ref('daily_report.concerns_manager_group'))]"/>
        <field name="domain_force">[('has_concerns', '=', True)]</field>
    </record>
</odoo>

